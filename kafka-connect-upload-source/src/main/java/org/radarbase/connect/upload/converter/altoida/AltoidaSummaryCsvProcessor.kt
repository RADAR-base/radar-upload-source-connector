package org.radarbase.connect.upload.converter.altoida

import org.apache.avro.generic.IndexedRecord
import org.radarbase.connect.upload.converter.SimpleCsvLineProcessor
import org.radarcns.connector.upload.altoida.AltoidaDomainResult
import org.radarcns.connector.upload.altoida.AltoidaSummary
import org.radarcns.connector.upload.altoida.AltoidaSummaryMetrics


class AltoidaSummaryCsvProcessor : AltoidaCsvProcessor() {
    override val fileNameSuffix: String = "export.csv"

    override val topic: String = "altoida_trial_summary"

    override fun SimpleCsvLineProcessor.lineConversion(line: Map<String, String>, timeReceived: Double): IndexedRecord {
        val bitMetrics = AltoidaSummaryMetrics()
        val dotMetrics = AltoidaSummaryMetrics()
        val domainResult = AltoidaDomainResult()

        return AltoidaSummary(
                time(line),
                timeReceived,
                line["LABEL"],
                line.getValue("AGE").toInt(),
                line.getValue("YEARSOFEDUCATION").toInt(),
                line.getValue("GENDER").toInt(),
                bitMetrics,
                dotMetrics,
                domainResult,
                line.getValue("CLASS").toInt(),
                line.getValue("NMI").toDouble(),
                line.getValue("GROUNDTRUTH").toInt()
        )
    }

    private fun extractTestMetrics(type: AltoidaTest, line: Map<String, String>): AltoidaSummaryMetrics {
        return AltoidaSummaryMetrics()
    }

    override val header: List<String> = listOf(
            "LABEL",
            "TIMESTAMP",
            "AGE",
            "YEARSOFEDUCATION",
            "GENDER",
            "BIT_PLAYHIGHREACTIONTIMES",
            "BIT_PLAYHIGHACCURACY",
            "BIT_PLAYLOWREACTIONS",
            "BIT_IGNOREDHIGHTONEPERCENTAGE",
            "BIT_PREMATURETONEBUTTONPRESSES",
            "BIT_RANDOMSCREENPRESSESDURINGPLACEMENT",
            "BIT_RANDOMSCREENPRESSESDURINGSEARCH",
            "BIT_TOOMUCHMOVEMENTCOUNT",
            "BIT_FINDBETTERPLACECOUNT",
            "BIT_INTROREADTIMES",
            "BIT_INTROREADTIME1",
            "BIT_INTROREADTIME2",
            "BIT_PLACEDELAYS",
            "BIT_PLACEDURATIONS",
            "BIT_PLACEDURATION1",
            "BIT_PLACEDURATION2",
            "BIT_PLACEDURATION3",
            "BIT_SPOTALREADYTAKENCOUNT",
            "BIT_FINDDURATIONS",
            "BIT_FINDDURATION1",
            "BIT_FINDDURATION2",
            "BIT_FINDDURATION3",
            "BIT_FINDFAILCOUNT",
            "BIT_FINDSKIPDURATIONS",
            "BIT_SKIPBUTTONCOUNT",
            "BIT_COUNTDOWNFAIL",
            "BIT_ANGULARCHANGEF1",
            "BIT_ANGULARCHANGEF2",
            "BIT_ANGULARCHANGEF3",
            "BIT_WALKTURNANALYSISF1",
            "BIT_WALKTURNANALYSISF2",
            "BIT_WALKTURNANALYSISF3",
            "BIT_WALKTURNANALYSISF",
            "BIT_DCOMPLEXITYF1",
            "BIT_DCOMPLEXITYF2",
            "BIT_DCOMPLEXITYF3",
            "BIT_STEPCOUNTPFRATIO",
            "BIT_MEANSTEPDELAYP",
            "BIT_MEANSTEPDELAYF",
            "BIT_STEPVARIANCEP",
            "BIT_STEPVARIANCEF",
            "BIT_NOTWALKINGTIMEP",
            "BIT_NOTWALKINGTIMEF",
            "BIT_SHOCKCOUNT",
            "BIT_ACCVARIANCE1",
            "BIT_ACCVARIANCE2",
            "BIT_ACCVARIANCE3",
            "BIT_STRONGHAND",
            "BIT_NORMCIRCLEMEAN",
            "BIT_NORMCIRCLEVARIANCE",
            "BIT_NORMCIRCLETIMERATIOWITHIN",
            "BIT_NORMCIRCLEDISTRATIOWITHIN",
            "BIT_NORMCIRCLEDISTWITHIN",
            "BIT_NORMCIRCLEDISTTOTAL",
            "BIT_NORMCIRCLEANGLESUM",
            "BIT_NORMCIRCLEDIRECTIONALCHANGES",
            "BIT_NORMCIRCLESPEED",
            "BIT_NORMCIRCLESPEEDACCURACYRATIO",
            "BIT_NORMCIRCLEDURATION",
            "BIT_NORMCIRCLEFULLDURATION",
            "BIT_NORMSQUAREMEAN",
            "BIT_NORMSQUAREVARIANCE",
            "BIT_NORMSQUARETIMERATIOWITHIN",
            "BIT_NORMSQUAREDISTRATIOWITHIN",
            "BIT_NORMSQUAREDISTWITHIN",
            "BIT_NORMSQUAREDISTTOTAL",
            "BIT_NORMSQUAREANGLESUM",
            "BIT_NORMSQUAREDIRECTIONALCHANGES",
            "BIT_NORMSQUARESPEED",
            "BIT_NORMSQUARESPEEDACCURACYRATIO",
            "BIT_NORMSQUAREDURATION",
            "BIT_NORMSQUAREFULLDURATION",
            "BIT_NORMSERPENTINEMEAN",
            "BIT_NORMSERPENTINEVARIANCE",
            "BIT_NORMSERPENTINETIMERATIOWITHIN",
            "BIT_NORMSERPENTINEDISTRATIOWITHIN",
            "BIT_NORMSERPENTINEDISTWITHIN",
            "BIT_NORMSERPENTINEDISTTOTAL",
            "BIT_NORMSERPENTINEYPROGRESS",
            "BIT_NORMSERPENTINESPEED",
            "BIT_NORMSERPENTINESPEEDACCURACYRATIO",
            "BIT_NORMSERPENTINEDURATION",
            "BIT_NORMSERPENTINEFULLDURATION",
            "BIT_NORMSPEEDCIRCLEMEAN",
            "BIT_NORMSPEEDCIRCLEVARIANCE",
            "BIT_NORMSPEEDCIRCLETIMERATIOWITHIN",
            "BIT_NORMSPEEDCIRCLEDISTRATIOWITHIN",
            "BIT_NORMSPEEDCIRCLEDISTWITHIN",
            "BIT_NORMSPEEDCIRCLEDISTTOTAL",
            "BIT_NORMSPEEDCIRCLEANGLESUM",
            "BIT_NORMSPEEDCIRCLEDIRECTIONALCHANGES",
            "BIT_NORMSPEEDCIRCLESPEED",
            "BIT_NORMSPEEDCIRCLESPEEDACCURACYRATIO",
            "BIT_NORMSPEEDCIRCLEDURATION",
            "BIT_NORMSPEEDCIRCLEFULLDURATION",
            "BIT_NORMRANDOMTAPPINGMEAN",
            "BIT_NORMRANDOMTAPPINGVARIANCE",
            "BIT_NORMRANDOMTAPPINGCOUNT",
            "BIT_NORMRANDOMTAPPINGREACTIONTIMES",
            "BIT_NORMRANDOMTAPPINGDURATION",
            "BIT_NORMRANDOMTAPPINGRATE",
            "BIT_NORMRANDOMTAPPINGFULLDURATION",
            "BIT_NORMTAPPINGMEAN",
            "BIT_NORMTAPPINGVARIANCE",
            "BIT_NORMTAPPINGCOUNT",
            "BIT_NORMTAPPINGREACTIONTIMES",
            "BIT_NORMTAPPINGRATE",
            "BIT_NORMTAPPINGDURATION",
            "BIT_NORMTAPPINGFULLDURATION",
            "DOT_PLAYHIGHREACTIONTIMES",
            "DOT_PLAYHIGHACCURACY",
            "DOT_PLAYLOWREACTIONS",
            "DOT_IGNOREDHIGHTONEPERCENTAGE",
            "DOT_PREMATURETONEBUTTONPRESSES",
            "DOT_RANDOMSCREENPRESSESDURINGPLACEMENT",
            "DOT_RANDOMSCREENPRESSESDURINGSEARCH",
            "DOT_TOOMUCHMOVEMENTCOUNT",
            "DOT_FINDBETTERPLACECOUNT",
            "DOT_INTROREADTIMES",
            "DOT_INTROREADTIME1",
            "DOT_INTROREADTIME2",
            "DOT_PLACEDELAYS",
            "DOT_PLACEDURATIONS",
            "DOT_PLACEDURATION1",
            "DOT_PLACEDURATION2",
            "DOT_PLACEDURATION3",
            "DOT_SPOTALREADYTAKENCOUNT",
            "DOT_FINDDURATIONS",
            "DOT_FINDDURATION1",
            "DOT_FINDDURATION2",
            "DOT_FINDDURATION3",
            "DOT_FINDFAILCOUNT",
            "DOT_FINDSKIPDURATIONS",
            "DOT_SKIPBUTTONCOUNT",
            "DOT_COUNTDOWNFAIL",
            "DOT_ANGULARCHANGEF1",
            "DOT_ANGULARCHANGEF2",
            "DOT_ANGULARCHANGEF3",
            "DOT_WALKTURNANALYSISF1",
            "DOT_WALKTURNANALYSISF2",
            "DOT_WALKTURNANALYSISF3",
            "DOT_WALKTURNANALYSISF",
            "DOT_DCOMPLEXITYF1",
            "DOT_DCOMPLEXITYF2",
            "DOT_DCOMPLEXITYF3",
            "DOT_STEPCOUNTPFRATIO",
            "DOT_MEANSTEPDELAYP",
            "DOT_MEANSTEPDELAYF",
            "DOT_STEPVARIANCEP",
            "DOT_STEPVARIANCEF",
            "DOT_NOTWALKINGTIMEP",
            "DOT_NOTWALKINGTIMEF",
            "DOT_SHOCKCOUNT",
            "DOT_ACCVARIANCE1",
            "DOT_ACCVARIANCE2",
            "DOT_ACCVARIANCE3",
            "DOT_STRONGHAND",
            "DOT_NORMCIRCLEMEAN",
            "DOT_NORMCIRCLEVARIANCE",
            "DOT_NORMCIRCLETIMERATIOWITHIN",
            "DOT_NORMCIRCLEDISTRATIOWITHIN",
            "DOT_NORMCIRCLEDISTWITHIN",
            "DOT_NORMCIRCLEDISTTOTAL",
            "DOT_NORMCIRCLEANGLESUM",
            "DOT_NORMCIRCLEDIRECTIONALCHANGES",
            "DOT_NORMCIRCLESPEED",
            "DOT_NORMCIRCLESPEEDACCURACYRATIO",
            "DOT_NORMCIRCLEDURATION",
            "DOT_NORMCIRCLEFULLDURATION",
            "DOT_NORMSQUAREMEAN",
            "DOT_NORMSQUAREVARIANCE",
            "DOT_NORMSQUARETIMERATIOWITHIN",
            "DOT_NORMSQUAREDISTRATIOWITHIN",
            "DOT_NORMSQUAREDISTWITHIN",
            "DOT_NORMSQUAREDISTTOTAL",
            "DOT_NORMSQUAREANGLESUM",
            "DOT_NORMSQUAREDIRECTIONALCHANGES",
            "DOT_NORMSQUARESPEED",
            "DOT_NORMSQUARESPEEDACCURACYRATIO",
            "DOT_NORMSQUAREDURATION",
            "DOT_NORMSQUAREFULLDURATION",
            "DOT_NORMSERPENTINEMEAN",
            "DOT_NORMSERPENTINEVARIANCE",
            "DOT_NORMSERPENTINETIMERATIOWITHIN",
            "DOT_NORMSERPENTINEDISTRATIOWITHIN",
            "DOT_NORMSERPENTINEDISTWITHIN",
            "DOT_NORMSERPENTINEDISTTOTAL",
            "DOT_NORMSERPENTINEYPROGRESS",
            "DOT_NORMSERPENTINESPEED",
            "DOT_NORMSERPENTINESPEEDACCURACYRATIO",
            "DOT_NORMSERPENTINEDURATION",
            "DOT_NORMSERPENTINEFULLDURATION",
            "DOT_NORMSPEEDCIRCLEMEAN",
            "DOT_NORMSPEEDCIRCLEVARIANCE",
            "DOT_NORMSPEEDCIRCLETIMERATIOWITHIN",
            "DOT_NORMSPEEDCIRCLEDISTRATIOWITHIN",
            "DOT_NORMSPEEDCIRCLEDISTWITHIN",
            "DOT_NORMSPEEDCIRCLEDISTTOTAL",
            "DOT_NORMSPEEDCIRCLEANGLESUM",
            "DOT_NORMSPEEDCIRCLEDIRECTIONALCHANGES",
            "DOT_NORMSPEEDCIRCLESPEED",
            "DOT_NORMSPEEDCIRCLESPEEDACCURACYRATIO",
            "DOT_NORMSPEEDCIRCLEDURATION",
            "DOT_NORMSPEEDCIRCLEFULLDURATION",
            "DOT_NORMRANDOMTAPPINGMEAN",
            "DOT_NORMRANDOMTAPPINGVARIANCE",
            "DOT_NORMRANDOMTAPPINGCOUNT",
            "DOT_NORMRANDOMTAPPINGREACTIONTIMES",
            "DOT_NORMRANDOMTAPPINGDURATION",
            "DOT_NORMRANDOMTAPPINGRATE",
            "DOT_NORMRANDOMTAPPINGFULLDURATION",
            "DOT_NORMTAPPINGMEAN",
            "DOT_NORMTAPPINGVARIANCE",
            "DOT_NORMTAPPINGCOUNT",
            "DOT_NORMTAPPINGREACTIONTIMES",
            "DOT_NORMTAPPINGRATE",
            "DOT_NORMTAPPINGDURATION",
            "DOT_NORMTAPPINGFULLDURATION",
            "DOMAINPERCENTILE_PERCEPTUALMOTORCOORDINATION",
            "DOMAINPERCENTILE_COMPLEXATTENTION",
            "DOMAINPERCENTILE_COGNITIVEPROCESSINGSPEED",
            "DOMAINPERCENTILE_INHIBITION",
            "DOMAINPERCENTILE_FLEXIBILITY",
            "DOMAINPERCENTILE_VISUALPERCEPTION",
            "DOMAINPERCENTILE_PLANNING",
            "DOMAINPERCENTILE_PROSPECTIVEMEMORY",
            "DOMAINPERCENTILE_SPATIALMEMORY",
            "CLASS",
            "NMI",
            "GROUNDTRUTH"
    )

    private enum class AltoidaTest {
        DOT,
        BIT
    }
}
